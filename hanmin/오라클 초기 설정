-- system 계정에서 시작
CREATE USER mis IDENTIFIED BY 12345 ACCOUNT UNLOCK;
GRANT UNLIMITED TABLESPACE TO mis;
ALTER USER mis DEFAULT TABLESPACE USERS;
ALTER USER mis TEMPORARY TABLESPACE TEMP;
GRANT CREATE SESSION TO mis;
GRANT CONNECT, RESOURCE TO mis;
GRANT SELECT ANY TABLE TO mis;
GRANT CREATE SYNONYM TO mis;
GRANT CREATE PUBLIC SYNONYM TO mis;
GRANT CREATE VIEW TO mis;
commit;

conn mis/12345;


*** mis 에서 ***
drop table member;

-- member 테이블 생성
  CREATE TABLE "MIS"."MEMBER" 
   (	"MNO" NUMBER(4,0), 
	"NICKNAME" VARCHAR2(30 CHAR) CONSTRAINT "MEMB_NICKNAME_NN" NOT NULL ENABLE,
    "NAME" VARCHAR2(30 CHAR) CONSTRAINT "MEMB_NAME_NN" NOT NULL ENABLE,
	"ID" VARCHAR2(30 CHAR) CONSTRAINT "MEMB_ID_NN" NOT NULL ENABLE, 
	"PW" VARCHAR2(30 CHAR) CONSTRAINT "MEMB_PW_NN" NOT NULL ENABLE, 
    "HOME" VARCHAR2(30 CHAR) CONSTRAINT "MEMB_HOME_NN" NOT NULL ENABLE, 
    "GEN" CHAR(1 BYTE) CONSTRAINT "MEMB_GEN_NN" NOT NULL ENABLE, 
    "JOINDATE" DATE DEFAULT SYSDATE CONSTRAINT "MEMB_DATE_NN" NOT NULL ENABLE,
	"ISSHOW" CHAR(1 BYTE) DEFAULT 'Y' CONSTRAINT "MEMB_SHOW_NN" NOT NULL ENABLE, 
	 CONSTRAINT "MEMB_GEN_CK" CHECK (gen IN ('F', 'M')) ENABLE,
     CONSTRAINT "MEMB_SHOW_CK" CHECK (isshow IN ('Y', 'N')) ENABLE, 
	 CONSTRAINT "MEMB_NO_PK" PRIMARY KEY ("MNO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE, 
	 CONSTRAINT "MEMB_ID_UK" UNIQUE ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE)
  SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

-- mno 시퀀스 생성
CREATE SEQUENCE mnoSeq
START WITH 1
INCREMENT BY 1
NOCACHE
NOCYCLE;

-- 시퀀스 확인
SELECT sequence_name
FROM user_sequences;
-- 위 명령을 실행했을 때 mnoSeq가 출력된다면 정상이다.

-- 임시 멤버 추가
INSERT INTO
			member(mno, nickname, name, id, pw, home, gen)
		VALUES(
			mnoSeq.NEXTVAL, 'nero', '김한민', 'hanmin', 12345, '서울', 'M'
		)
        ;
commit;

-- 멤버 카운트
SELECT
    COUNT(*) cnt
FROM
    member
WHERE
    id = 'hanmin'
    AND pw = 12345;
    
-- 멤버 아이디 확인
SELECT
    id
FROM
    member;

-- id 로 회원 정보 확인
SELECT
    nickname, name, id, home, gen, joindate jdate
FROM
    member
WHERE
    id = 'hanmin'
;
 
commit;

drop table park;

-- 태마파크 테이블 생성
CREATE TABLE park(
    pno NUMBER(4)
        CONSTRAINT PARK_PNO_PK PRIMARY KEY,
    pname VARCHAR2(100)
        CONSTRAINT PARK_PNAME_NN NOT NULL,
    pmis VARCHAR2(100),
    pcity VARCHAR2(100)
        CONSTRAINT PARK_PCITY_NN NOT NULL,
    pkreview VARCHAR2(100)
        CONSTRAINT PARK_PKREVIEW_NN NOT NULL,
    plink VARCHAR2(4000)
        CONSTRAINT PARK_PLINK_NN NOT NULL
);

-- pno 시퀀스 생성
CREATE SEQUENCE pnoSeq
START WITH 1
INCREMENT BY 1
NOCACHE
NOCYCLE;

SELECT
    pno, pname, pmis, pcity, pkreview, plink, 
FROM
    park
WHERE
    pname = pname
ORDER BY
    pno DESC
;
SELECT
    rno, pno, pname, pmis, pcity, pkreview, plink
FROM
(
    SELECT
        ROWNUM rno, pno, pname, pmis, pcity, pkreview, plink
    FROM
        (
        SELECT
            pno, pname, pmis, pcity, pkreview, plink
        FROM
            park
        WHERE
            pname = pname
        ORDER BY
            pno DESC
        )
)
WHERE
    rno BETWEEN 1 AND 70
;

-- pno로 모든 정보 확인
SELECT
    pno, pname, pmis, pcity, pkreview, plink
FROM
    park
WHERE
    pno = 34;

-- park테이블의 카운트
SELECT
    COUNT(*)
FROM
    park
;
