<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pSQL">

	<!-- pno로 그 글의 정보를 가지고 오기 위한 코드 -->
	<select id="getPark" resultType="pVO" parameterType="pVO">
		SELECT
			pno, pname, pmis, pcity, pkreview, plink, distinct(decode(substr(pcity,1,2),'서울',substr(pcity,4,4), '부산', substr(pcity,4,4), '전북', substr(pcity,4,4), '제주', substr(pcity,4,4),substr(pcity,1,2))) city
		FROM
			park
		WHERE
			pno = #{pno}
	</select>
	<!-- 태마파크의 모든 정보 리스트를 가지고 오기 위한 코드 -->
	<select id="getParkList" resultType="pVO" parameterType="page">
		SELECT
		    rno, pno, pname, pmis, pcity, pkreview, plink
		FROM
		(
		    SELECT
			    ROWNUM rno, pno, pname, pmis, pcity, pkreview, plink
			FROM
			    (
			    SELECT
			        pno, pname, pmis, pcity, pkreview, plink
			    FROM
			        park
			    WHERE
			        pname = pname
			    ORDER BY
			        pno DESC
			        
			    )
			order by
			    to_number(pkreview) desc
		)
		WHERE
		    rno BETWEEN #{startRno} AND #{endRno}
	</select>
	<!-- 태마파크의 페이징처리를 위한 토탈 카운트 -->
	<select id="getParkTotal" resultType="int">
		SELECT
			COUNT(*)
		FROM
			park
	</select>

</mapper>